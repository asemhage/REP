# مخطط مراحل التنفيذ العملية

> **الغرض:** تحويل خطة المشروع إلى مسارات عمل واضحة قابلة للتنفيذ مع تحديد المخرجات والمسؤوليات لكل مرحلة.  
> **نطاق الوثيقة:** منصة الحجز العقاري الليبية (خيار التقنية A: Django + React + Flutter).

## المرحلة 0 – الإعداد المؤسسي (2 أسابيع)
- **الأهداف:** تأسيس البنية الإدارية، حسم العقود مع مزودي الاستضافة والدفع، تحديد الحوكمة الأمنية.  
- **المخرجات:**  
  - عقود/اتفاقيات خدمة مع مزوّد الاستضافة المحلي وبوابة الدفع.  
  - سياسة هوية وحوكمة بيانات معتمدة (KYC، حفظ السجلات، إدارة الدفع النقدي).  
  - خطة أمان أساسية (Security Playbook) تشمل إدارة الأسرار، النسخ الاحتياطي، خطة الاستجابة للحوادث.
- **المسؤوليات الأساسية:** الإدارة التنفيذية، الأمن السيبراني، الشؤون القانونية.
- **نقطة الانتقال:** توافر بيئة تطوير سحابية/محلية جاهزة وملف إعدادات أمني معتمد.

## المرحلة 1 – التحليل المفصل والنماذج الأولية (4 أسابيع)
- **الأهداف:** إنهاء تحليل المتطلبات، الاتفاق على تجربة المستخدم، وتثبيت المخطط المعماري.  
- **المخرجات:**  
  - قصص مستخدمين ومخططات حالات الاستخدام محدثة.  
  - نماذج واجهة تفاعلية (Figma) لكل المسارات الحرجة (تسجيل، تصفح، حجز، إدارة).  
  - وثيقة قرارات معمارية (ADR) تتضمن قاعدة البيانات، خدمات الإشعارات، هيكلة الرسائل الصوتية.
- **المسؤوليات:** منتج، UX/UI، معماري النظام، قادة الفرق التقنية.  
- **نقطة الانتقال:** مواءمة الفرق على المتطلبات النهائية وتجميد نطاق الإصدار الأول (MVP).

## المرحلة 2 – البنية الخلفية الأساسية (8 أسابيع)
- **الأهداف:** بناء واجهات REST الأساسية، قاعدة البيانات، وخدمات الهوية.  
- **المخرجات:**  
  - تطبيق Django REST مع وحدات المستخدمين، العقارات، الصالات، الحجوزات، المدفوعات.  
  - نظام مصادقة JWT مع دعم MFA وإدارة الصلاحيات.  
  - مخطط قاعدة بيانات Postgres + ترحيلات Alembic، وخدمات Celery/Redis للمهام الخلفية.  
  - اختبارات وحدات/تكامل رئيسية (pytest + coverage ≥ 70%).  
- **المسؤوليات:** فريق الواجهة الخلفية، مهندس بيانات، الأمن السيبراني.  
- **نقطة الانتقال:** نجاح اختبار الدخان للـ APIs على بيئة Staging مبكرة وتوثيق Swagger أولي.

## المرحلة 3 – الواجهة الأمامية للويب (6 أسابيع)
- **الأهداف:** تنفيذ واجهة React/Next.js، تكاملها مع الـ APIs، ودعم RTL والتوطين.  
- **المخرجات:**  
  - صفحات رئيسية، تصفح العقارات/الصالات، تفاصيل الحجز، لوحة المستثمر، لوحة الإدارة الأساسية.  
  - نظام حالة (React Query أو Redux Toolkit) مع إدارة الجلسة وتحديث الوقت الحقيقي للإشعارات.  
  - دعم لغة عربية كاملة وتهيئة الدينار الليبي وتنسيقات التواريخ المحلية.  
  - اختبارات واجهة (Playwright أو Cypress) للمسارات الحرجة.  
- **المسؤوليات:** فريق الواجهة الأمامية، QA.  
- **نقطة الانتقال:** قبول UX، اختبارات واجهة ناجحة، ودمج البوابة الخلفية دون اختناقات.

## المرحلة 4 – تطبيقات الأجهزة الذكية (6 أسابيع)
- **الأهداف:** تطوير تطبيق Flutter للمستثمرين والمستأجرين مع تجربة متنقلة سلسة.  
- **المخرجات:**  
  - وحدات التسجيل/الدخول، التصفح، الحجز، إدارة العربون، الإشعارات الفورية.  
  - دعم تشغيل/تسجيل الرسائل الصوتية، العمل دون اتصال جزئي (Offline-first) للطلبات.  
  - نشر بناء تجريبي عبر TestFlight / Google Play Internal.  
- **المسؤوليات:** فريق الموبايل، Backend API للدعم، QA.  
- **نقطة الانتقال:** اعتماد نسخة Beta مستقرة، تكامل الإشعارات والصوت بالكامل.

## المرحلة 5 – التكاملات المالية والاتصالات (4 أسابيع متداخلة)
- **الأهداف:** ربط بوابة الدفع المحلية، رسائل SMS، وخدمات الخرائط.  
- **المخرجات:**  
  - تدفق عربون مرن (بطاقة أو نقد) مع سجل تدقيق كامل.  
  - Webhooks للمدفوعات مع معالجة حالات الاسترداد والفشل.  
  - خدمات إشعار SMS/Email مترجمة، وتوليد وصلات الخرائط وفق صلاحيات الدور.  
- **المسؤوليات:** فريق التكاملات، الأمن السيبراني، المالية.  
- **نقطة الانتقال:** اجتياز اختبارات الدفع الطرفية واعتماد سياسة المصالحة المالية.

## المرحلة 6 – الجودة والأمن الموسع (4 أسابيع)
- **الأهداف:** رفع الكفاءة التشغيلية، إجراء اختبارات أمنية وأداء شاملة.  
- **المخرجات:**  
  - خطة اختبار كاملة (وظائفية، تحميل، اختراق) وتقارير نتائج.  
  - نظام مراقبة (ELK أو بديل محلي) مع اللوحات والإنذارات.  
  - تغطية اختبار تلقائي ≥ 80% للمسارات الحرجة، وخطة التعافي من الكوارث.  
- **المسؤوليات:** QA، الأمن السيبراني، SRE/DevOps.  
- **نقطة الانتقال:** توقيع شهادة جاهزية الإنتاج من الفرق المعنية.

## المرحلة 7 – الإطلاق التجريبي والانتقال للإنتاج (4 أسابيع)
- **الأهداف:** تشغيل نسخة Beta محدودة، جمع الملاحظات، التحضير للإطلاق الرسمي.  
- **المخرجات:**  
  - نشر نسخة Beta على بيئة إنتاج محدودة، نظام دعم مستخدمين، ولوحات متابعة الأداء.  
  - خطة تحسين بناءً على بيانات الاستخدام وردود الفعل.  
  - وثائق تدريب، أدلة المستخدم، وسياسة تسعير/عروض للمستثمرين الأوائل.  
- **المسؤوليات:** فريق المنتج، الدعم الفني، التسويق.  
- **نقطة الانتقال:** استيفاء معايير النجاح (KPIs) وتصفية المشاكل الحرجة.

## المرحلة 8 – الإطلاق الرسمي والتحسين المستمر (مستمر)
- **الأهداف:** فتح المنصة للجمهور الليبي، دعم العمليات، وتخطيط خارطة الطريق.  
- **المخرجات:**  
  - نشر كامل مع مراقبة 24/7 وخطط استجابة للطوارئ.  
  - تنفيذ حملات تسويق محلية، تقارير أداء شهرية، وجدول تحسينات ربع سنوي.  
  - خطط توسع جغرافي/وظيفي (مثل إضافة مبيعات، إدارة صيانة متقدمة، ذكاء أعمال).  
- **المسؤوليات:** كل الفرق (تشغيل، منتج، تسويق، أمن).  
- **نقطة الانتقال:** دورة تحسين مستمرة (Continuous Improvement) مع مراجعات ربع سنوية.

---

### تبعيات مشتركة
- تحديث توثيق `docs/core/api_endpoints.md` مع كل مرحلة تؤثر على الـ APIs.  
- استخدام Jira أو أداة مكافئة لربط قصص المستخدمين بالمراحل أعلاه.  
- تفعيل اجتماعات مراجعة أسبوعية للمرحلة الجارية، وإعداد تقرير حالة موحد (Status Report).  
- الالتزام بقواعد الحوكمة المذكورة في `rules.md` أثناء جميع المراحل.

---

## حالة التنفيذ
- **المرحلة 0:** مكتملة – تم إنشاء البنية المؤسسية، ملفات البيئات، وتهيئة docker-compose.  
- **المرحلة 1:** قيد الإنجاز – تم إعداد قصص المستخدمين (`phase1_user_stories.yaml`)، مسارات UX (`phase1_ux_flows.yaml`)، وقرارات معمارية (`architecture_decisions.yaml`). انتظار المراجعة قبل الانتقال للمرحلة التالية.

