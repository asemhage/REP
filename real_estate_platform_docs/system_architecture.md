# تصميم هيكل النظام والواجهات

## 1. معمارية النظام

### 1.1. نظرة عامة على المعمارية

تعتمد منصة العقارات على معمارية ثلاثية الطبقات (Three-Tier Architecture) مع فصل واضح بين طبقة العرض (Presentation Layer)، طبقة المنطق التجاري (Business Logic Layer)، وطبقة البيانات (Data Layer). هذا التصميم يضمن قابلية التوسع، سهولة الصيانة، والأمان.

### 1.2. المكونات الرئيسية

#### 1.2.1. الواجهة الأمامية (Frontend)
- **تطبيق ويب متجاوب:** يدعم جميع الأجهزة (سطح المكتب، الأجهزة اللوحية، الهواتف الذكية)
- **تطبيق جوال أصلي:** للمستثمرين والمستأجرين (iOS و Android)
- **لوحة تحكم الإدارة:** واجهة مخصصة لمالك المنصة

#### 1.2.2. الواجهة الخلفية (Backend)
- **خادم التطبيق:** يدير المنطق التجاري والـ APIs
- **خادم قاعدة البيانات:** يخزن جميع البيانات
- **خادم الملفات:** لتخزين الصور والملفات الصوتية
- **خدمات خارجية:** بوابات الدفع، خدمات الرسائل، خرائط

#### 1.2.3. الأمان والمصادقة
- **نظام إدارة الهوية:** للمصادقة والتفويض
- **تشفير البيانات:** حماية البيانات الحساسة
- **جدار الحماية:** حماية من الهجمات الخارجية

## 2. قاعدة البيانات

### 2.1. الجداول الرئيسية

#### جدول المستخدمين (Users)
- user_id (Primary Key)
- user_type (investor/tenant/admin)
- email, phone, password_hash
- profile_data (JSON)
- verification_status
- created_at, updated_at

#### جدول العقارات (Properties)
- property_id (Primary Key)
- owner_id (Foreign Key to Users)
- property_type (property/hall), location, area
- rooms, bathrooms, amenities (JSON)
- daily_rate, monthly_rate, sale_price
- status (available/maintenance/sold)
- created_at, updated_at

#### جدول الصالات (Halls)
- hall_id (Primary Key)
- owner_id (Foreign Key to Users)
- hall_type, location, area
- capacity, amenities (JSON)
- morning_rate, evening_rate, full_day_rate
- status (available/maintenance)
- created_at, updated_at

#### جدول الحجوزات (Bookings)
- booking_id (Primary Key)
- property_id (Foreign Key to Properties)
- hall_id (Foreign Key to Halls, nullable)
- tenant_id (Foreign Key to Users)
- start_date, end_date
- time_slot (morning/evening/full_day, nullable for properties)
- total_amount, status
- voice_message_url
- created_at, updated_at

#### جدول التقييمات (Reviews)
- review_id (Primary Key)
- property_id (Foreign Key to Properties, nullable)
- hall_id (Foreign Key to Halls, nullable)
- tenant_id (Foreign Key to Users)
- rating, comment
- time_slot_rating (JSON, optional for halls)
- created_at

## 3. تصميم واجهات المستخدم

سنقوم الآن بتصميم الواجهات الرئيسية للمنصة:



### 3.1. الصفحة الرئيسية (Homepage)

تم تصميم الصفحة الرئيسية لتوفر تجربة مستخدم سلسة وجذابة، تتضمن:

- **شريط التنقل العلوي:** يحتوي على شعار المنصة وروابط للأقسام الرئيسية (العقارات، الإيجار اليومي، بوابة المستثمرين، حساب المستخدم)
- **قسم البحث الرئيسي:** يتضمن حقول البحث المتقدم (نوع العقار، الموقع، نطاق السعر، تاريخ الإقامة)
- **عرض العقارات المميزة:** شبكة من بطاقات العقارات تعرض الصور، الأسعار، والتقييمات
- **تصميم متجاوب:** يتكيف مع جميع أحجام الشاشات

### 3.2. لوحة تحكم المستثمر (Investor Dashboard)

تم تصميم لوحة تحكم شاملة للمستثمرين تتضمن:

- **الشريط الجانبي:** قائمة تنقل تحتوي على إدارة العقارات، الحجوزات، التقارير المالية، والإعدادات
- **نظرة عامة مالية:** رسوم بيانية تفاعلية تعرض الأداء المالي ونمو الاستثمار
- **إدارة الحجوزات:** جدول يعرض الحجوزات الحديثة مع إمكانية الموافقة/الرفض
- **تشغيل الرسائل الصوتية:** أزرار لتشغيل الرسائل الصوتية المرفقة مع طلبات الحجز
- **مؤشرات الأداء:** عرض الدخل الحالي، الدخل المتوقع، وأداء العقارات

### 3.3. صفحة تفاصيل العقار والصالة (Property/Hall Listing)

تعرض تفاصيل شاملة للعقار أو الصالة وتتضمن:

- **معرض الصور:** عرض تفاعلي للصور مع إمكانية التنقل والتكبير
- **تفاصيل العقار/الصالة:** معلومات شاملة عن المساحة، عدد الغرف/الطاولات، المرافق، والموقع
- **تقويم التوفر:** 
  * للعقارات: يعرض الأيام المحجوزة والمتاحة بوضوح
  * للصالات: يعرض الأيام المحجوزة والمتاحة مع تحديد الفترات المتاحة (صباحي/مسائي/كامل اليوم)
- **نموذج طلب الحجز:** 
  * للعقارات: يتضمن تحديد تواريخ الإقامة وإمكانية تسجيل رسالة صوتية
  * للصالات: يتضمن تحديد التواريخ والفترات المطلوبة (صباحي/مسائي/كامل اليوم) وإمكانية تسجيل رسالة صوتية
- **قسم التقييمات:** عرض تقييمات المستأجرين السابقين مع النجوم والتعليقات
  * للصالات: عرض تقييمات منفصلة للفترات الصباحية والمسائية عند توفرها
- **معلومات المالك:** تفاصيل الاتصال وإمكانية التواصل المباشر

### 3.4. تطبيق الجوال (Mobile App)

تم تصميم تطبيق جوال أصلي يتضمن:

- **واجهة رئيسية:** عرض العقارات المميزة مع إمكانية البحث السريع
- **تفاصيل العقار:** عرض محسن للجوال مع معرض صور تفاعلي
- **لوحة تحكم المستثمر:** نسخة محسنة للجوال من لوحة التحكم
- **إدارة الحجوزات:** واجهة سهلة للموافقة/الرفض على الطلبات
- **إشعارات فورية:** تنبيهات للحجوزات الجديدة والرسائل

## 4. تدفق العمليات (Workflow)

### 4.1. تدفق عملية حجز العقار

1. **البحث والاستكشاف:** المستأجر يبحث عن العقارات المناسبة
2. **عرض التفاصيل:** مراجعة تفاصيل العقار والتوفر
3. **طلب الحجز:** إرسال طلب حجز مع رسالة صوتية اختيارية
4. **مراجعة المستثمر:** المستثمر يراجع الطلب ويستمع للرسالة الصوتية
5. **الموافقة/الرفض:** المستثمر يتخذ قرار بشأن الطلب
6. **تأكيد الحجز:** إرسال تأكيد للمستأجر وتحديث التقويم
7. **تسليم المفاتيح:** المستثمر يؤكد حضور المستأجر
8. **التقييم:** المستأجر يقيم العقار بعد انتهاء الإقامة

### 4.2. تدفق عملية حجز الصالة

1. **البحث والاستكشاف:** المستأجر يبحث عن الصالات المناسبة
2. **عرض التفاصيل:** مراجعة تفاصيل الصالة والتوفر حسب الفترات (صباحي/مسائي/كامل اليوم)
3. **طلب الحجز:** إرسال طلب حجز مع تحديد الفترة/الفترات المطلوبة ورسالة صوتية اختيارية
4. **مراجعة المستثمر:** المستثمر يراجع الطلب ويستمع للرسالة الصوتية
5. **الموافقة/الرفض:** المستثمر يتخذ قرار بشأن الطلب
6. **تأكيد الحجز:** إرسال تأكيد للمستأجر وتحديث التقويم
7. **تسليم الصالة:** المستثمر يؤكد حضور المستأجر واستلام الصالة
8. **التقييم:** المستأجر يقيم الصالة بعد انتهاء الحدث

### 4.3. تدفق إدارة العقار

1. **إضافة العقار:** المستثمر يضيف تفاصيل العقار والصور
2. **تحديد الأسعار:** تحديد أسعار الإيجار اليومي والشهري
3. **إدارة التوفر:** تحديث التقويم وحالة العقار
4. **وضع الصيانة:** تعطيل العقار مؤقتاً للصيانة
5. **تتبع الأداء:** مراجعة التقارير المالية والإحصائيات

### 4.4. تدفق إدارة الصالة

1. **إضافة الصالة:** المستثمر يضيف تفاصيل الصالة والصور
2. **تحديد الأسعار:** تحديد أسعار الإيجار للفترات (صباحي/مسائي/كامل اليوم)
3. **إدارة التوفر:** تحديث التقويم وحالة الصالة حسب الفترات
4. **وضع الصيانة:** تعطيل الصالة مؤقتاً للصيانة
5. **تتبع الأداء:** مراجعة التقارير المالية والإحصائيات حسب الفترات

## 5. الأمان والخصوصية

### 5.1. حماية البيانات

- **تشفير البيانات:** جميع البيانات الحساسة مشفرة أثناء النقل والتخزين
- **المصادقة الثنائية:** خيار إضافي لحماية الحسابات
- **التحقق من الهوية:** ربط مع أنظمة التحقق الحكومية

### 5.2. أمان المعاملات

- **بوابات دفع آمنة:** استخدام بوابات دفع معتمدة ومشفرة
- **سجل المعاملات:** تتبع كامل لجميع المعاملات المالية
- **حماية من الاحتيال:** أنظمة كشف الأنشطة المشبوهة

## 6. التكامل مع الخدمات الخارجية

### 6.1. خدمات الخرائط

- **عرض المواقع:** تكامل مع خرائط Google لعرض مواقع العقارات
- **التنقل:** إرشادات الوصول للعقارات

### 6.2. خدمات الاتصالات

- **الرسائل النصية:** إشعارات SMS للحجوزات والتحديثات
- **البريد الإلكتروني:** رسائل تأكيد وتقارير دورية
- **الإشعارات الفورية:** Push notifications للتطبيق الجوال

### 6.3. بوابات الدفع

- **دفع متعدد:** دعم بطاقات الائتمان، المحافظ الرقمية، والتحويل البنكي
- **عملات متعددة:** دعم العملات المحلية والدولية

## 7. قابلية التوسع والصيانة

### 7.1. البنية التحتية

- **الحوسبة السحابية:** استخدام خدمات سحابية قابلة للتوسع
- **توزيع الأحمال:** توزيع الطلبات على خوادم متعددة
- **النسخ الاحتياطي:** نسخ احتياطية منتظمة للبيانات

### 7.2. المراقبة والتحليل

- **مراقبة الأداء:** تتبع أداء النظام والاستجابة
- **تحليل الاستخدام:** فهم سلوك المستخدمين وتحسين التجربة
- **تقارير الأخطاء:** نظام تلقائي لرصد وإصلاح الأخطاء

هذا التصميم يوفر أساساً قوياً لمنصة عقارية شاملة تلبي احتياجات جميع المستخدمين مع ضمان الأمان، الأداء، وسهولة الاستخدام.

